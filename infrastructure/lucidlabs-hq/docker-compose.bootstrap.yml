# =============================================================================
# LUCIDLABS-HQ - Bootstrap (Elestio Initial Setup)
#
# MINIMAL compose for Elestio provisioning.
# Use this in Elestio UI, then SSH in and run setup.sh for full config.
#
# After server is up:
#   ssh root@<server-ip>
#   git clone git@github.com:lucidlabs-hq/agent-kit.git /tmp/agent-kit
#   cd /tmp/agent-kit/infrastructure/lucidlabs-hq
#   ./setup.sh
# =============================================================================

services:
  caddy:
    image: caddy:2-alpine
    container_name: lucidlabs-caddy
    restart: unless-stopped
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - caddy_data:/data
      - caddy_config:/config
    command: caddy respond --listen :80 "LUCIDLABS-HQ OK - Run setup.sh to configure"

  watchtower:
    image: containrrr/watchtower
    container_name: lucidlabs-watchtower
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - TZ=Europe/Berlin
      - WATCHTOWER_CLEANUP=true
      - WATCHTOWER_POLL_INTERVAL=300
      - WATCHTOWER_LABEL_ENABLE=true

networks:
  lucidlabs-network:
    name: lucidlabs-network
    driver: bridge

volumes:
  caddy_data:
    name: lucidlabs-caddy-data
  caddy_config:
    name: lucidlabs-caddy-config
